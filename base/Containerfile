ARG from
FROM $from

COPY etc/ /etc/
COPY usr/ /usr/

# workaround (see https://github.com/ublue-os/bluefin-lts/issues/3)
RUN mkdir -p /var/roothome

# make /usr/local and /opt directories mutable
RUN rm -rf /usr/local && \
    rm -rf /opt && \
    ln -s /var/usrlocal /usr/local && \
    ln -s /var/opt /opt

RUN dnf -y install 'dnf5-command(copr)'

# base groups
RUN dnf -y install \
    @core \
    @hardware-support \
    @standard \
    @base-graphical \
    --exclude dracut-config-rescue

RUN dnf -y install \
    fedora-release-ostree-desktop \
    fedora-release-mobility \
    systemd-oomd-defaults \
    systemd-resolved \
    grub2-efi-aa64-modules \
    grub2-efi-aa64 \
    glibc-langpack-en \
    udisks2-btrfs \
    btrfs-progs \
    fuse

# utils
RUN dnf -y install \
    NetworkManager-wifi \
    NetworkManager-tui \
    git

# default fonts
RUN dnf -y install \
    default-fonts-cjk-mono \
    default-fonts-cjk-sans \
    default-fonts-cjk-serif \
    default-fonts-core-emoji \
    default-fonts-core-math \
    default-fonts-core-mono \
    default-fonts-core-sans \
    default-fonts-core-serif \
    default-fonts-other-mono \
    default-fonts-other-sans \
    default-fonts-other-serif

# cleanup
RUN dnf clean all && rm -rf /var/log/*

RUN bootc container lint --no-truncate
